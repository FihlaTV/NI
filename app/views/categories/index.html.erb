<%- model_class = Category -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
  <h3>A list of categories and themes covered by articles in New Internationalist magazine. <%= link_to retina_image_tag("iphone-dark.png", :alt => "Open these categories in the New Internationalist magazine app for iPad and iPhone.", :title => "Open these categories in the New Internationalist magazine app for iPad and iPhone.", :size => "14x24", :class => 'ios-issue-page'), app_link(categories_path) %></h3>
</div>
<table class="table table-striped">
  <thead>
    <tr>
      <!-- <th><%= model_class.human_attribute_name(:id) %></th> -->
      <th>&nbsp;</th>
      <th><%= model_class.human_attribute_name(:name) %></th>
      <th>Latest article published</th>
      <th>Date published</th>
    </tr>
  </thead>
  <tbody>
    <% @categories.each do |category| %>
      <% if category.latest_published_article %>
      <tr>
        <!-- <td><%= link_to category.id, category_path(category) %></td> -->
        <td style="background-color: <%= category.colour_as_hex %>">&nbsp;</td>
        <td><%= link_to category.display_name, category_path(category) %></td>
        <td><%= link_to category.latest_published_article.title, issue_article_path(category.latest_published_article.issue, category.latest_published_article) %></td>
        <td><%= category.latest_published_article.publication.strftime("%B, %Y") %></td>
      </tr>
      <% end %>
    <% end %>
  </tbody>
</table>